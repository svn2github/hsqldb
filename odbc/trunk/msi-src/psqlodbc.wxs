<?xml version="1.0" encoding="utf-8"?>
<!--
    $Id$

    Wix MSI Installer


    HyperSQL ODBC Driver

    Significant modifications Copyright 2009 by
    the HSQL Development Group.  Changes made by the HSQL
    Development are documented precisely in the public HyperSQL
    source code repository, available through http://hsqldb.org.

    This library is free software; you can redistribute it and/or
    modify it under the terms of the GNU Library General Public
    License as published by the Free Software Foundation; either
    version 2 of the License, or (at your option) any later version.

    This library is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
    Library General Public License for more details.

    You should have received a copy of the GNU Library General Public
    License along with this library; if not, write to the
    Free Foundation, Inc., 51 Franklin Street, Fifth Floor,
    Boston, MA  02110-1301  USA
-->

<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">

  <Product Manufacturer="The HSQL Development Group"
           Id="4733F470-9DFC-3410-8556-C309E4D95A02"
           UpgradeCode="99878FE9-3C9C-3C51-8CEC-BB6291A6B490"
           Name="HyperSQL ODBC Driver"
           Version="$(var.VERSION)"
           Language="1033">

    <Package Keywords="HSQLDB, HyperSQL, ODBC"
             Comments="HyperSQL ODBC Driver"
             Manufacturer="The HSQL Development Group"
             InstallerVersion="300"
             Languages="1033"
             Compressed="yes"
             SummaryCodepage="1252" />

    <Directory Id="TARGETDIR" Name="SourceDir">

      <!-- Shared assembly runtime for VS 2005 -->
      <Merge Id="msvcr90dll" Language="0" DiskId="1"
             SourceFile="$(var.PROGRAMCOM)/Microsoft_VC90_CRT_x86.msm"/>
      <Merge Id="msvcr90policy" Language="0" DiskId="1"
         SourceFile="$(var.PROGRAMCOM)/policy_9_0_Microsoft_VC90_CRT_x86.msm"/>

      <Directory Id="ProgramFilesFolder" Name="PFiles">
        <Directory Id="BASEDIR" Name="hsqlodbc">
          <Directory Id="BINDIR" Name="bin">
            <Component Id="registration"
                       Guid="8D8EDBDF-0114-3B3E-A2BC-E9F8F675C178">
              <RegistryValue KeyPath="yes" Type="string" Root="HKLM"
                             Key="Software\hsqlodbc" Name="Version"
                             Value="$(var.VERSION)" />
            </Component>
            <Merge Id="hsqlodbcm" DiskId="1" Language="1033"
                   SourceFile="psqlodbc.msm" />
          </Directory>
          <Directory Id="DOCSDIR" Name="docs">
            <Component Id="docs" Guid="91C8184E-C164-31A0-A594-545B3E46D4D6">
              <File Id="docs.index_html" Name="index.html"
                    DiskId="1" Source="../doc/index.html" KeyPath="yes" />
              <File Id="docs.config_html" Name="config.html"
                    DiskId="1" Source="../doc/config.html" />
              <File Id="docs.config_opt_html" Name="config-opt.html"
                    DiskId="1" Source="../doc/config-opt.html" />
              <File Id="docs.faq_html" Name="faq.html"
                    DiskId="1" Source="../doc/faq.html" />
              <File Id="docs.howto_accesslo_html" Name="howto-accesslo.html"
                    DiskId="1" Source="../doc/howto-accesslo.html" />
              <File Id="docs.howto_accessvba_html" Name="howto-accessvba.html"
                    DiskId="1" Source="../doc/howto-accessvba.html" />
              <File Id="docs.howto_bo_html" Name="howto-bo.html"
                    DiskId="1" Source="../doc/howto-bo.html" />
              <File Id="docs.howto_ch_html" Name="howto-ch.html"
                    DiskId="1" Source="../doc/howto-ch.html" />
              <File Id="docs.howto_csharp_html" Name="howto-csharp.html"
                    DiskId="1" Source="../doc/howto-csharp.html" />
              <File Id="docs.howto_vb_html" Name="howto-vb.html"
                    DiskId="1" Source="../doc/howto-vb.html" />
              <File Id="docs.howto_vblo_html" Name="howto-vblo.html"
                    DiskId="1" Source="../doc/howto-vblo.html" />
              <File Id="docs.release_html" Name="release.html"
                    DiskId="1" Source="../doc/release.html" />
              <File Id="docs.unix_compilation_html"
                    Name="unix-compilation.html"
                    DiskId="1" Source="../doc/unix-compilation.html" />
              <File Id="docs.win32_compilation_html"
                    Name="win32-compilation.html"
                    DiskId="1" Source="../doc/win32-compilation.html" />
              <File Id="docs.notice_txt" Name="notice.txt"
                    DiskId="1" Source="../doc/notice.txt" />

              <Shortcut Id="docs.index_html" Directory="SMDir"
                        Name="Documentation index"
                        Description="hsqlodbc documentation, HOWTOs and FAQs"
                        Advertise="yes" Show="normal" />
            </Component>
          </Directory>
        </Directory>
      </Directory>
      <Directory Id="ProgramMenuFolder" Name="." SourceName="Programs">
        <Directory Id="SMDir" Name="hsqlodbc">
          <Component Id="smdir" Guid="7F26DF6E-A06C-36AE-9792-EF5D5276BB17">
            <RegistryValue KeyPath="yes" Type="string" Root="HKCU"
                           Key="Software\hsqlodbc\SMDir Created" Value="y" />
            <RemoveFolder Id="SMDir" On="uninstall" />
          </Component>
        </Directory>
      </Directory>
    </Directory>

    <Feature Id="hsqlodbc" Title="hsqlodbc" Level="1"
             Description="hsqlodbc - The HyperSQL ODBC Driver"
             ConfigurableDirectory="BASEDIR" Display="expand">
      <Feature Id="binaries" Title="ODBC Driver" Level="1"
               Description="The ODBC driver and supporting libraries.">
        <ComponentRef Id="registration" />
        <MergeRef Id="hsqlodbcm" />
        <MergeRef Id="msvcr90dll" />
        <MergeRef Id="msvcr90policy" />
      </Feature>

      <Feature Id="docs" Title="Documentation" Level="4"
               Description="Documentation, FAQs and HOWTOs.">
        <ComponentRef Id="smdir" />
        <ComponentRef Id="docs" />
      </Feature>
    </Feature>
    <Media Id="1" EmbedCab="yes" Cabinet="hsqlodbc.cab"/>

    <Property Id="ALLUSERS">2</Property>
    <Property Id="WIXUI_INSTALLDIR" Value="BASEDIR" />

     <!-- UI -->
     <UIRef Id="WixUI_FeatureTree" />
     <WixVariable Id="WixUILicenseRtf" Value="lgpl.rtf" />
     <WixVariable Id="WixUIDialogBmp" Value="background.bmp" />
     <WixVariable Id="WixUIBannerBmp" Value="banner.bmp" />
  </Product>
</Wix>
