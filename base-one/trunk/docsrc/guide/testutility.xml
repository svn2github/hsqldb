<!-- $Id$ -->

<appendix>
    <title>HSQLDB Test Utility</title>
    <appendixinfo>
        <edition>$Revision$</edition>
        <pubdate>$Date$</pubdate>
        <keywordset>
            <keyword>Hsqldb</keyword>
            <keyword>Test</keyword>
            <keyword>Utility</keyword>
        </keywordset>
    </appendixinfo>

   <section>
        <title>Purpose</title>
        <para>
            The <literal>org.hsqldb.test</literal> package contains a number of 
            tests for various functions of the database engine.
            Among these, the TestSelf class performs the tests that are based 
            on scripts.
            To run the tests, you should compile the
            <filename>hsqldbtest.jar</filename> target with Ant.
        </para> <para>
            For TestSelf, a batch file is provided in the demo directory.
            To start the application in Windows, type:
        </para><screen>
    runtest TestSelf</screen>
        <para>
            The new version of TestSelf runs multiple SQL test files to test 
            different SQL operations of the database.
            All files in the working directory with names matching
            TestSelf*.txt are processed in alphabetical order.
        </para> <para>
            You can add your own scripts to test different series of SQL 
            queries.
            The format of the TestSelf*.txt file is simple text, with some 
            indentation and prefixes in the form of Java-style comments.
            These prefixes indicate what the expected result should be.
        </para> <itemizedlist>
            <listitem><para>
                Comment lines must start with -- and are ignored
            </para></listitem><listitem><para>
                Lines starting with spaces are the continuation of the previous 
                line
            </para></listitem><listitem><para>
                Line prefixes indicate:
                </para><variablelist>
                    <varlistentry>
                        <term>/*c&lt;rows&gt;*/</term>
                        <listitem><para>
                            ResultSet is expected with &lt;rows> column count
                        </para></listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>/*u &lt;count&gt;*/</term>
                        <listitem><para>
                            An update count, &lt;count> is expected
                        </para></listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>/*e*/</term>
                        <listitem><para>
                            An erro should occur when executing the statement
                        </para></listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>/* r &lt;string1>,&lt;string2>*/</term>
                        <listitem><para>
                            Single-row ResultSet is expected with &lt;string1>,
                            &lt;string2> results in the single row
                        </para></listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>/*r...</term>
                        <listitem><programlisting>
/*r
&lt;string1>,&lt;string2>
&lt;string1>,&lt;string2>
&lt;string1>,&lt;string2>
*/</programlisting>
                        <para>
                            Multiple row ResultSet is expected with the 
                            specified values (note the indentation) SQL 
                            statements with no prefix are simply executed.
                        </para></listitem>
                    </varlistentry>
                </variablelist>
            </listitem>
        </itemizedlist>
        <para>
            See the TestSelf*.txt files for actual examples.
        </para>
    </section>
</appendix>
