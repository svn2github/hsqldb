-- TESTS FOR CASE AND SIMILAR OPERATIONS
--
drop table testcase if exists;
create table testcase(id integer, data varchar(10), filler varchar(10));
insert into testcase values(100,'xxxx',null);
insert into testcase values(200,'yyyy',null);
/*u1*/insert into testcase values(300,null,null);
/*r300*/select id from testcase where data is null;
/*c2*/select id from testcase where data is not null;
/*rNULLVALUE*/select ifnull(data,'NULLVALUE') from testcase where data is null;
/*rNULLVALUE*/select case data when 'xxxx' then 'X' else 'NULLVALUE' end from testcase where data is null;
SELECT CASE data WHEN 'xxxx' THEN 'X' ELSE (CASE data WHEN 'yyyy' THEN 'Y' ELSE (CASE data WHEN 'zzzz' THEN 'Z' ELSE 'NOTFOUND' END) END) END FROM testcase;
SELECT CASE data WHEN 'xxxx' THEN 'X' WHEN 'yyyy' THEN 'Y' WHEN 'zzzz' THEN 'Z' ELSE 'NOTFOUND' END FROM testcase;
/*rALLNULL*/SELECT COALESCE (filler, data, 'ALLNULL') FROM testcase WHERE id = 300;
/*r600.0*/select cast (sum(id) as double) from testcase;
/*r600*/select coalesce(sum(id), 0) from testcase;
/*r600.0*/select abs(coalesce(sum(id), 0)) from testcase;
drop table testcase2 if exists;
create table testcase2(id integer, data varchar(10), filler varchar(10));
/*rNULL*/select cast (sum(id) as double) from testcase2;
/*r0*/select coalesce(sum(id), 0) from testcase2;
/*r0.0*/select abs(coalesce(sum(id), 0)) from testcase2;
